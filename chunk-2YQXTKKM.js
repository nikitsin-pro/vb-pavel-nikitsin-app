import{b as z,c as xe,m as _e,p as h,q as Oe,r as be,t as V,u as Pe,v as Ce,w as Ee,x as Ae,y as Se}from"./chunk-RMRZQJ42.js";import{a as we}from"./chunk-P7WAMOVV.js";import{$ as U,K as re,Ma as Me,O as se,Oa as ge,Pa as he,R as k,Sa as ye,Z as ae,_ as E,a as _,b as I,ba as le,ca as $,da as ce,ea as j,fa as pe,ga as ue,ha as L,ia as M,ja as O,ka as N,la as T,m as ie,ma as x,na as de,oa as ee,pa as te,q as ne,ra as me,sa as K,ta as D,v as oe,ya as fe,za as ve}from"./chunk-EVQQARIZ.js";function Ue(){return{ids:[],entities:{}}}function $e(){function e(r={}){return Object.assign(Ue(),r)}return{getInitialState:e}}function je(){function e(r){let a=f=>f.ids,u=f=>f.entities,v=h(a,u,(f,A)=>f.map(S=>A[S])),g=h(a,f=>f.length);return r?{selectIds:h(r,a),selectEntities:h(r,u),selectAll:h(r,v),selectTotal:h(r,g)}:{selectIds:a,selectEntities:u,selectAll:v,selectTotal:g}}return{getSelectors:e}}var s=function(e){return e[e.EntitiesOnly=0]="EntitiesOnly",e[e.Both=1]="Both",e[e.None=2]="None",e}(s||{});function d(e){return function(a,u){let v={ids:[...u.ids],entities:_({},u.entities)},g=e(a,v);return g===s.Both?Object.assign({},u,v):g===s.EntitiesOnly?I(_({},u),{entities:v.entities}):u}}function P(e,r){let a=r(e);return fe()&&a===void 0&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",r.toString()),a}function Be(e){function r(c,n){let i=P(c,e);return i in n.entities?s.None:(n.ids.push(i),n.entities[i]=c,s.Both)}function a(c,n){let i=!1;for(let t of c)i=r(t,n)!==s.None||i;return i?s.Both:s.None}function u(c,n){return n.ids=[],n.entities={},a(c,n),s.Both}function v(c,n){let i=P(c,e);return i in n.entities?(n.entities[i]=c,s.EntitiesOnly):(n.ids.push(i),n.entities[i]=c,s.Both)}function g(c,n){let i=c.map(t=>v(t,n));switch(!0){case i.some(t=>t===s.Both):return s.Both;case i.some(t=>t===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}function f(c,n){return A([c],n)}function A(c,n){let t=(c instanceof Array?c:n.ids.filter(o=>c(n.entities[o]))).filter(o=>o in n.entities).map(o=>delete n.entities[o]).length>0;return t&&(n.ids=n.ids.filter(o=>o in n.entities)),t?s.Both:s.None}function S(c){return Object.assign({},c,{ids:[],entities:{}})}function W(c,n,i){let t=i.entities[n.id],o=Object.assign({},t,n.changes),l=P(o,e),p=l!==n.id;return p&&(c[n.id]=l,delete i.entities[n.id]),i.entities[l]=o,p}function R(c,n){return w([c],n)}function w(c,n){let i={};return c=c.filter(o=>o.id in n.entities),c.length>0?c.filter(l=>W(i,l,n)).length>0?(n.ids=n.ids.map(l=>i[l]||l),s.Both):s.EntitiesOnly:s.None}function B(c,n){let t=n.ids.reduce((o,l)=>{let p=c(n.entities[l]);return p!==n.entities[l]&&o.push({id:l,changes:p}),o},[]).filter(({id:o})=>o in n.entities);return w(t,n)}function X({map:c,id:n},i){let t=i.entities[n];if(!t)return s.None;let o=c(t);return R({id:n,changes:o},i)}function Z(c,n){return F([c],n)}function F(c,n){let i=[],t=[];for(let p of c){let m=P(p,e);m in n.entities?t.push({id:m,changes:p}):i.push(p)}let o=w(t,n),l=a(i,n);switch(!0){case(l===s.None&&o===s.None):return s.None;case(l===s.Both||o===s.Both):return s.Both;default:return s.EntitiesOnly}}return{removeAll:S,addOne:d(r),addMany:d(a),setAll:d(u),setOne:d(v),setMany:d(g),updateOne:d(R),updateMany:d(w),upsertOne:d(Z),upsertMany:d(F),removeOne:d(f),removeMany:d(A),map:d(B),mapOne:d(X)}}function Ke(e,r){let{removeOne:a,removeMany:u,removeAll:v}=Be(e);function g(i,t){return f([i],t)}function f(i,t){let o=i.filter(l=>!(P(l,e)in t.entities));return o.length===0?s.None:(n(o,t),s.Both)}function A(i,t){return t.entities={},t.ids=[],f(i,t),s.Both}function S(i,t){let o=P(i,e);return o in t.entities?(t.ids=t.ids.filter(l=>l!==o),n([i],t),s.Both):g(i,t)}function W(i,t){let o=i.map(l=>S(l,t));switch(!0){case o.some(l=>l===s.Both):return s.Both;case o.some(l=>l===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}function R(i,t){return B([i],t)}function w(i,t,o){if(!(t.id in o.entities))return!1;let l=o.entities[t.id],p=Object.assign({},l,t.changes),m=P(p,e);return delete o.entities[t.id],i.push(p),m!==t.id}function B(i,t){let o=[],l=i.filter(p=>w(o,p,t)).length>0;if(o.length===0)return s.None;{let p=t.ids,m=[];return t.ids=t.ids.filter((y,C)=>y in t.entities?!0:(m.push(C),!1)),n(o,t),!l&&m.every(y=>t.ids[y]===p[y])?s.EntitiesOnly:s.Both}}function X(i,t){let o=t.ids.reduce((l,p)=>{let m=i(t.entities[p]);return m!==t.entities[p]&&l.push({id:p,changes:m}),l},[]);return B(o,t)}function Z({map:i,id:t},o){let l=o.entities[t];if(!l)return s.None;let p=i(l);return R({id:t,changes:p},o)}function F(i,t){return c([i],t)}function c(i,t){let o=[],l=[];for(let y of i){let C=P(y,e);C in t.entities?l.push({id:C,changes:y}):o.push(y)}let p=B(l,t),m=f(o,t);switch(!0){case(m===s.None&&p===s.None):return s.None;case(m===s.Both||p===s.Both):return s.Both;default:return s.EntitiesOnly}}function n(i,t){i.sort(r);let o=[],l=0,p=0;for(;l<i.length&&p<t.ids.length;){let m=i[l],y=P(m,e),C=t.ids[p],Fe=t.entities[C];r(m,Fe)<=0?(o.push(y),l++):(o.push(C),p++)}l<i.length?t.ids=o.concat(i.slice(l).map(e)):t.ids=o.concat(t.ids.slice(p)),i.forEach((m,y)=>{t.entities[e(m)]=m})}return{removeOne:a,removeMany:u,removeAll:v,addOne:d(g),updateOne:d(R),upsertOne:d(F),setAll:d(A),setOne:d(S),setMany:d(W),addMany:d(f),updateMany:d(B),upsertMany:d(c),map:d(X),mapOne:d(Z)}}function Ie(e={}){let{selectId:r,sortComparer:a}={selectId:e.selectId??(f=>f.id),sortComparer:e.sortComparer??!1},u=$e(),v=je(),g=a?Ke(r,a):Be(r);return _(_(_({selectId:r,sortComparer:a},u),v),g)}var b=xe({source:"Popular Movies",events:{"Load Popular Movies":z(),"Load Popular Movies Success":z(),"Load Popular Movies Failure":z()}});var Y="popularMovies",H=Ie({selectId:e=>e.id}),De=H.getInitialState({page:1,total_pages:0,total_results:0,loading:!1,error:!1}),Le=Pe(De,V(b.loadPopularMovies,e=>I(_({},e),{loading:!0,error:!1})),V(b.loadPopularMoviesSuccess,(e,r)=>H.setAll(r.results,I(_({},e),{page:r.page,total_pages:r.total_pages,total_results:r.total_results,loading:!1,error:!1}))),V(b.loadPopularMoviesFailure,e=>I(_({},e),{loading:!1,error:!0})));var G=class e{actions$=k(Ee);tmdbApi=k(we);loadPopularMovies$=Ce(()=>this.actions$.pipe(Ae(b.loadPopularMovies),re(({page:r})=>this.tmdbApi.loadPopularMovies({page:r}).pipe(ne(a=>b.loadPopularMoviesSuccess({results:a.results,page:a.page,total_pages:a.total_pages,total_results:a.total_results})),oe(a=>ie(b.loadPopularMoviesFailure({error:a})))))));static \u0275fac=function(a){return new(a||e)};static \u0275prov=se({token:e,factory:e.\u0275fac})};var q=Oe(Y),{selectAll:ze}=H.getSelectors(),Re=h(q,ze),ke=h(q,e=>e.loading),Te=h(q,e=>e.error),Ot=h(q,e=>({page:e.page,total_pages:e.total_pages,total_results:e.total_results}));var Ye=e=>["/popular",e];function He(e,r){if(e&1&&N(0,"img",1),e&2){let a=T();L("alt",te("Poster for ",a.movie.title))("src",a.movie.imageUrl,ae)}}function Ge(e,r){if(e&1&&N(0,"img",2),e&2){let a=T();L("alt",te("No poster available for ",a.movie.title))}}var J=class e{movie;static \u0275fac=function(a){return new(a||e)};static \u0275cmp=U({type:e,selectors:[["app-movie-card"]],inputs:{movie:[2,"movie","movie",r=>({id:r.id,title:r.title,imageUrl:r.poster_path?`https://image.tmdb.org/t/p/w92/${r.poster_path}`:void 0,releaseDate:r.release_date,voteAverage:r.vote_average.toFixed(1)})]},decls:15,vars:8,consts:[["routerLinkActive","router-link-active",1,"movie-card",3,"routerLink"],[3,"src","alt"],["src","images/poster-placeholder.svg",3,"alt"],[1,"info-block"],[1,"ellipsis"],["aria-hidden","true",1,"metrics"]],template:function(a,u){a&1&&(M(0,"a",0),$(1,He,1,3,"img",1)(2,Ge,1,2,"img",2),M(3,"div",3)(4,"h2",4),x(5),O(),M(6,"div",5)(7,"div",4),x(8,"rating: "),M(9,"span"),x(10),O()(),M(11,"div",4),x(12,"released: "),M(13,"span"),x(14),O()()()()()),a&2&&(L("routerLink",me(6,Ye,u.movie.id)),le("aria-label",`${u.movie.title}, rating: ${u.movie.voteAverage} out of 10, released: ${u.movie.releaseDate}`),E(),j(u.movie.imageUrl?1:2),E(4),de(u.movie.title),E(5),ee(" ",u.movie.voteAverage," / 10"),E(4),ee(" ",u.movie.releaseDate))},dependencies:[ye,ge,he],styles:[".movie-card[_ngcontent-%COMP%]{max-width:100%;display:flex;justify-content:stretch;gap:16px;border-radius:8px;overflow:hidden;background-color:var(--surface);cursor:pointer;container-type:inline-size}.img[_ngcontent-%COMP%]{width:92px;height:138px}.info-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:4px;padding:8px 0;overflow:hidden;text-decoration:none}.info-block[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:400}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]{display:flex;color:var(--text-secondary);font-size:18px}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:not(:last-child){margin-right:16px}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600}@container (max-width: 440px){.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]{flex-direction:column;font-size:16px}}"]})};var qe=(e,r)=>r.id;function Je(e,r){e&1&&(M(0,"h1",2),x(1,"Loading..."),O())}function Qe(e,r){e&1&&(M(0,"h1",3),x(1,"Something went wrong"),O())}function We(e,r){if(e&1&&N(0,"app-movie-card",4),e&2){let a=r.$implicit;L("movie",a)}}function Xe(e,r){e&1&&(M(0,"h1",5),x(1," No movies found"),O())}function Ze(e,r){if(e&1&&(pe(0,We,1,1,"app-movie-card",4,qe,!1,Xe,2,0,"h1",5),K(3,"async")),e&2){let a=T();ue(D(3,1,a.movies$))}}var Q=class e{store=k(_e);movies$=this.store.select(Re);loading$=this.store.select(ke);error$=this.store.select(Te);ngOnInit(){this.store.dispatch(b.loadPopularMovies({page:1}))}static \u0275fac=function(a){return new(a||e)};static \u0275cmp=U({type:e,selectors:[["app-popular-movies"]],decls:9,vars:5,consts:[["id","page-title",1,"title","ellipsis"],["aria-labelledby","page-title",1,"container"],["role","status","aria-live","polite",1,"placeholder-text"],["role","alert",1,"placeholder-text","alert"],[3,"movie"],[1,"placeholder-text"]],template:function(a,u){a&1&&(M(0,"h1",0),x(1,"Popular movies"),O(),M(2,"section",1),$(3,Je,2,0,"h1",2),K(4,"async"),K(5,"async"),ce(6,Qe,2,0,"h1",3)(7,Ze,4,3),O(),N(8,"router-outlet")),a&2&&(E(3),j(D(4,1,u.loading$)?3:D(5,3,u.error$)?6:7))},dependencies:[J,Me,ve],styles:["[_nghost-%COMP%]{height:100vh;display:flex;flex-direction:column;align-items:center}.title[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;height:40px;padding:10px 0;text-align:center;color:var(--text-light);background-color:var(--primary-900);font-weight:500}.container[_ngcontent-%COMP%]{margin-top:70px;width:100%;max-width:1000px;display:flex;flex-direction:column;gap:8px;padding:0 10px;box-sizing:border-box}.container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{margin-top:40px;text-align:center;color:var(--text-secondary);font-weight:400}.container[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{color:var(--accent-700)}"]})};var Dt=[{path:"",component:Q,providers:[be(Y,Le),Se(G)],children:[{path:":id",loadChildren:()=>import("./chunk-RULMQ23H.js").then(e=>e.movieDetailsRoutes)}]},{path:"**",redirectTo:""}];export{Dt as popularMoviesRoutes};
