import{A as re,c as H,d as Ce,n as Ee,q as h,r as Se,s as Ae,u as V,v as we,w as Ie,x as Be,y as Le,z as Ne}from"./chunk-DPCHA65X.js";import{$ as K,D as pe,H as U,Ha as be,Ja as xe,K as E,Ka as Oe,Na as Pe,U as ue,V as S,W as $,Y as de,Z as j,_ as me,a as b,aa as fe,b as L,ba as ve,ca as N,da as g,ea as x,fa as R,ia as T,j as ae,ja as _,ka as ge,l as le,la as ie,ma as oe,na as Me,oa as D,p as ce,pa as z,ua as he,va as ye,xa as ne,ya as _e}from"./chunk-K5SMGXUR.js";function Ke(){return{ids:[],entities:{}}}function De(){function e(o={}){return Object.assign(Ke(),o)}return{getInitialState:e}}function ze(){function e(o){let r=f=>f.ids,u=f=>f.entities,v=h(r,u,(f,A)=>f.map(w=>A[w])),M=h(r,f=>f.length);return o?{selectIds:h(o,r),selectEntities:h(o,u),selectAll:h(o,v),selectTotal:h(o,M)}:{selectIds:r,selectEntities:u,selectAll:v,selectTotal:M}}return{getSelectors:e}}var a=function(e){return e[e.EntitiesOnly=0]="EntitiesOnly",e[e.Both=1]="Both",e[e.None=2]="None",e}(a||{});function d(e){return function(r,u){let v={ids:[...u.ids],entities:b({},u.entities)},M=e(r,v);return M===a.Both?Object.assign({},u,v):M===a.EntitiesOnly?L(b({},u),{entities:v.entities}):u}}function P(e,o){let r=o(e);return he()&&r===void 0&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",e,"The `selectId` implementation:",o.toString()),r}function Re(e){function o(c,n){let i=P(c,e);return i in n.entities?a.None:(n.ids.push(i),n.entities[i]=c,a.Both)}function r(c,n){let i=!1;for(let t of c)i=o(t,n)!==a.None||i;return i?a.Both:a.None}function u(c,n){return n.ids=[],n.entities={},r(c,n),a.Both}function v(c,n){let i=P(c,e);return i in n.entities?(n.entities[i]=c,a.EntitiesOnly):(n.ids.push(i),n.entities[i]=c,a.Both)}function M(c,n){let i=c.map(t=>v(t,n));switch(!0){case i.some(t=>t===a.Both):return a.Both;case i.some(t=>t===a.EntitiesOnly):return a.EntitiesOnly;default:return a.None}}function f(c,n){return A([c],n)}function A(c,n){let t=(c instanceof Array?c:n.ids.filter(s=>c(n.entities[s]))).filter(s=>s in n.entities).map(s=>delete n.entities[s]).length>0;return t&&(n.ids=n.ids.filter(s=>s in n.entities)),t?a.Both:a.None}function w(c){return Object.assign({},c,{ids:[],entities:{}})}function q(c,n,i){let t=i.entities[n.id],s=Object.assign({},t,n.changes),l=P(s,e),p=l!==n.id;return p&&(c[n.id]=l,delete i.entities[n.id]),i.entities[l]=s,p}function k(c,n){return I([c],n)}function I(c,n){let i={};return c=c.filter(s=>s.id in n.entities),c.length>0?c.filter(l=>q(i,l,n)).length>0?(n.ids=n.ids.map(l=>i[l]||l),a.Both):a.EntitiesOnly:a.None}function B(c,n){let t=n.ids.reduce((s,l)=>{let p=c(n.entities[l]);return p!==n.entities[l]&&s.push({id:l,changes:p}),s},[]).filter(({id:s})=>s in n.entities);return I(t,n)}function ee({map:c,id:n},i){let t=i.entities[n];if(!t)return a.None;let s=c(t);return k({id:n,changes:s},i)}function te(c,n){return F([c],n)}function F(c,n){let i=[],t=[];for(let p of c){let m=P(p,e);m in n.entities?t.push({id:m,changes:p}):i.push(p)}let s=I(t,n),l=r(i,n);switch(!0){case(l===a.None&&s===a.None):return a.None;case(l===a.Both||s===a.Both):return a.Both;default:return a.EntitiesOnly}}return{removeAll:w,addOne:d(o),addMany:d(r),setAll:d(u),setOne:d(v),setMany:d(M),updateOne:d(k),updateMany:d(I),upsertOne:d(te),upsertMany:d(F),removeOne:d(f),removeMany:d(A),map:d(B),mapOne:d(ee)}}function He(e,o){let{removeOne:r,removeMany:u,removeAll:v}=Re(e);function M(i,t){return f([i],t)}function f(i,t){let s=i.filter(l=>!(P(l,e)in t.entities));return s.length===0?a.None:(n(s,t),a.Both)}function A(i,t){return t.entities={},t.ids=[],f(i,t),a.Both}function w(i,t){let s=P(i,e);return s in t.entities?(t.ids=t.ids.filter(l=>l!==s),n([i],t),a.Both):M(i,t)}function q(i,t){let s=i.map(l=>w(l,t));switch(!0){case s.some(l=>l===a.Both):return a.Both;case s.some(l=>l===a.EntitiesOnly):return a.EntitiesOnly;default:return a.None}}function k(i,t){return B([i],t)}function I(i,t,s){if(!(t.id in s.entities))return!1;let l=s.entities[t.id],p=Object.assign({},l,t.changes),m=P(p,e);return delete s.entities[t.id],i.push(p),m!==t.id}function B(i,t){let s=[],l=i.filter(p=>I(s,p,t)).length>0;if(s.length===0)return a.None;{let p=t.ids,m=[];return t.ids=t.ids.filter((y,C)=>y in t.entities?!0:(m.push(C),!1)),n(s,t),!l&&m.every(y=>t.ids[y]===p[y])?a.EntitiesOnly:a.Both}}function ee(i,t){let s=t.ids.reduce((l,p)=>{let m=i(t.entities[p]);return m!==t.entities[p]&&l.push({id:p,changes:m}),l},[]);return B(s,t)}function te({map:i,id:t},s){let l=s.entities[t];if(!l)return a.None;let p=i(l);return k({id:t,changes:p},s)}function F(i,t){return c([i],t)}function c(i,t){let s=[],l=[];for(let y of i){let C=P(y,e);C in t.entities?l.push({id:C,changes:y}):s.push(y)}let p=B(l,t),m=f(s,t);switch(!0){case(m===a.None&&p===a.None):return a.None;case(m===a.Both||p===a.Both):return a.Both;default:return a.EntitiesOnly}}function n(i,t){i.sort(o);let s=[],l=0,p=0;for(;l<i.length&&p<t.ids.length;){let m=i[l],y=P(m,e),C=t.ids[p],je=t.entities[C];o(m,je)<=0?(s.push(y),l++):(s.push(C),p++)}l<i.length?t.ids=s.concat(i.slice(l).map(e)):t.ids=s.concat(t.ids.slice(p)),i.forEach((m,y)=>{t.entities[e(m)]=m})}return{removeOne:r,removeMany:u,removeAll:v,addOne:d(M),updateOne:d(k),upsertOne:d(F),setAll:d(A),setOne:d(w),setMany:d(q),addMany:d(f),updateMany:d(B),upsertMany:d(c),map:d(ee),mapOne:d(te)}}function ke(e={}){let{selectId:o,sortComparer:r}={selectId:e.selectId??(f=>f.id),sortComparer:e.sortComparer??!1},u=De(),v=ze(),M=r?He(o,r):Re(o);return b(b(b({selectId:o,sortComparer:r},u),v),M)}var O=Ce({source:"Popular Movies",events:{"Load Popular Movies":H(),"Load Popular Movies Success":H(),"Load Popular Movies Failure":H()}});var Y="popularMovies",G=ke({selectId:e=>e.id}),Ve=G.getInitialState({page:1,total_pages:0,total_results:0,loading:!1,error:!1}),Te=we(Ve,V(O.loadPopularMovies,e=>L(b({},e),{loading:!0,error:!1})),V(O.loadPopularMoviesSuccess,(e,o)=>G.setAll(o.results,L(b({},e),{page:o.page,total_pages:o.total_pages,total_results:o.total_results,loading:!1,error:!1}))),V(O.loadPopularMoviesFailure,e=>L(b({},e),{loading:!1,error:!0})));var J=class e{http=E(_e);searchMovies(o,r=1){let u=new ne().set("query",o).set("page",r.toString()).set("include_adult","false").set("language","en-US");return this.http.get(`${re.tmdbApiURL}/search/movie`,{params:u})}loadPopularMovies(o={}){let r=new ne().set("include_adult",(o.include_adult??!1).toString()).set("include_video",(o.include_video??!1).toString()).set("page",(o.page??1).toString()).set("sort_by",o.sort_by??"popularity.desc");return o.region&&(r=r.set("region",o.region)),this.http.get(`${re.tmdbApiURL}/discover/movie`,{params:r})}static \u0275fac=function(r){return new(r||e)};static \u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"})};var Q=class e{actions$=E(Be);tmdbApi=E(J);loadPopularMovies$=Ie(()=>this.actions$.pipe(Le(O.loadPopularMovies),pe(({page:o})=>this.tmdbApi.loadPopularMovies({page:o}).pipe(le(r=>O.loadPopularMoviesSuccess({results:r.results,page:r.page,total_pages:r.total_pages,total_results:r.total_results})),ce(r=>ae(O.loadPopularMoviesFailure({error:r})))))));static \u0275fac=function(r){return new(r||e)};static \u0275prov=U({token:e,factory:e.\u0275fac})};var W=Se(Y),{selectAll:Ye}=G.getSelectors(),Fe=h(W,Ye),Ue=h(W,e=>e.loading),$e=h(W,e=>e.error),It=h(W,e=>({page:e.page,total_pages:e.total_pages,total_results:e.total_results}));var Je=e=>["/popular",e];function Qe(e,o){if(e&1&&R(0,"img",1),e&2){let r=T();N("alt",oe("Poster for ",r.movie.title))("src",r.movie.imageUrl,ue)}}function We(e,o){if(e&1&&R(0,"img",2),e&2){let r=T();N("alt",oe("No poster available for ",r.movie.title))}}var X=class e{movie;static \u0275fac=function(r){return new(r||e)};static \u0275cmp=$({type:e,selectors:[["app-movie-card"]],inputs:{movie:[2,"movie","movie",o=>({id:o.id,title:o.title,imageUrl:o.poster_path?`https://image.tmdb.org/t/p/w92/${o.poster_path}`:void 0,releaseDate:o.release_date,voteAverage:o.vote_average.toFixed(1)})]},decls:15,vars:8,consts:[["routerLinkActive","router-link-active",1,"movie-card",3,"routerLink"],[3,"src","alt"],["src","images/poster-placeholder.svg",3,"alt"],[1,"info-block"],[1,"ellipsis"],["aria-hidden","true",1,"metrics"]],template:function(r,u){r&1&&(g(0,"a",0),j(1,Qe,1,3,"img",1)(2,We,1,2,"img",2),g(3,"div",3)(4,"h2",4),_(5),x(),g(6,"div",5)(7,"div",4),_(8,"rating: "),g(9,"span"),_(10),x()(),g(11,"div",4),_(12,"released: "),g(13,"span"),_(14),x()()()()()),r&2&&(N("routerLink",Me(6,Je,u.movie.id)),de("aria-label",`${u.movie.title}, rating: ${u.movie.voteAverage} out of 10, released: ${u.movie.releaseDate}`),S(),K(u.movie.imageUrl?1:2),S(4),ge(u.movie.title),S(5),ie(" ",u.movie.voteAverage," / 10"),S(4),ie(" ",u.movie.releaseDate))},dependencies:[Pe,xe,Oe],styles:[".movie-card[_ngcontent-%COMP%]{max-width:100%;display:flex;justify-content:stretch;gap:16px;border-radius:8px;overflow:hidden;background-color:var(--surface);cursor:pointer;container-type:inline-size}.img[_ngcontent-%COMP%]{width:92px;height:138px}.info-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;gap:4px;padding:8px 0;overflow:hidden;text-decoration:none}.info-block[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:400}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]{display:flex;color:var(--text-secondary);font-size:18px}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:not(:last-child){margin-right:16px}.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600}@container (max-width: 440px){.info-block[_ngcontent-%COMP%]   .metrics[_ngcontent-%COMP%]{flex-direction:column;font-size:16px}}"]})};var Xe=(e,o)=>o.id;function Ze(e,o){e&1&&(g(0,"h1",2),_(1,"Loading..."),x())}function qe(e,o){e&1&&(g(0,"h1",3),_(1,"Something went wrong"),x())}function et(e,o){if(e&1&&R(0,"app-movie-card",4),e&2){let r=o.$implicit;N("movie",r)}}function tt(e,o){e&1&&(g(0,"h1",5),_(1," No movies found"),x())}function it(e,o){if(e&1&&(fe(0,et,1,1,"app-movie-card",4,Xe,!1,tt,2,0,"h1",5),D(3,"async")),e&2){let r=T();ve(z(3,1,r.movies$))}}var Z=class e{store=E(Ee);movies$=this.store.select(Fe);loading$=this.store.select(Ue);error$=this.store.select($e);ngOnInit(){this.store.dispatch(O.loadPopularMovies({page:1}))}static \u0275fac=function(r){return new(r||e)};static \u0275cmp=$({type:e,selectors:[["app-popular-movies"]],decls:9,vars:5,consts:[["id","page-title",1,"title","ellipsis"],["aria-labelledby","page-title",1,"container"],["role","status","aria-live","polite",1,"placeholder-text"],["role","alert",1,"placeholder-text","alert"],[3,"movie"],[1,"placeholder-text"]],template:function(r,u){r&1&&(g(0,"h1",0),_(1,"Popular movies"),x(),g(2,"section",1),j(3,Ze,2,0,"h1",2),D(4,"async"),D(5,"async"),me(6,qe,2,0,"h1",3)(7,it,4,3),x(),R(8,"router-outlet")),r&2&&(S(3),K(z(4,1,u.loading$)?3:z(5,3,u.error$)?6:7))},dependencies:[X,be,ye],styles:["[_nghost-%COMP%]{height:100vh;display:flex;flex-direction:column;align-items:center}.title[_ngcontent-%COMP%]{position:fixed;top:0;width:100%;height:40px;padding:10px 0;text-align:center;color:var(--text-light);background-color:var(--primary-900);font-weight:500}.container[_ngcontent-%COMP%]{margin-top:70px;width:100%;max-width:1000px;display:flex;flex-direction:column;gap:8px;padding:0 10px;box-sizing:border-box}.container[_ngcontent-%COMP%]   .placeholder-text[_ngcontent-%COMP%]{margin-top:40px;text-align:center;color:var(--text-secondary);font-weight:400}.container[_ngcontent-%COMP%]   .alert[_ngcontent-%COMP%]{color:var(--accent-700)}"]})};var Wt=[{path:"",component:Z,providers:[Ae(Y,Te),Ne(Q)],children:[{path:":id",loadChildren:()=>import("./chunk-HLRO7STU.js").then(e=>e.movieDetailsRoutes)}]},{path:"**",redirectTo:""}];export{Wt as popularMoviesRoutes};
